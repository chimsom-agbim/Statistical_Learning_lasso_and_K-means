Lasso_and_K-means
================
2024-11-01

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(glmnet)
```

    ## Loading required package: Matrix
    ## 
    ## Attaching package: 'Matrix'
    ## 
    ## The following objects are masked from 'package:tidyr':
    ## 
    ##     expand, pack, unpack
    ## 
    ## Loaded glmnet 4.1-8

``` r
set.seed(11)
```

\##Lasso

So to study this, we’ll look at data studying birthweight. “frace” and
“mrace” are race categories in the dataset. It’s always good to read the
dataset first so you know what you’re working with.

``` r
read_csv("extra_topic_data/birthweight.csv")
```

    ## Rows: 4342 Columns: 20
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    ## # A tibble: 4,342 × 20
    ##    babysex bhead blength   bwt delwt fincome frace gaweeks malform menarche
    ##      <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl> <dbl>   <dbl>   <dbl>    <dbl>
    ##  1       2    34      51  3629   177      35     1    39.9       0       13
    ##  2       1    34      48  3062   156      65     2    25.9       0       14
    ##  3       2    36      50  3345   148      85     1    39.9       0       12
    ##  4       1    34      52  3062   157      55     1    40         0       14
    ##  5       2    34      52  3374   156       5     1    41.6       0       13
    ##  6       1    33      52  3374   129      55     1    40.7       0       12
    ##  7       2    33      46  2523   126      96     2    40.3       0       14
    ##  8       2    33      49  2778   140       5     1    37.4       0       12
    ##  9       1    36      52  3515   146      85     1    40.3       0       11
    ## 10       1    33      50  3459   169      75     2    40.7       0       12
    ## # ℹ 4,332 more rows
    ## # ℹ 10 more variables: mheight <dbl>, momage <dbl>, mrace <dbl>, parity <dbl>,
    ## #   pnumlbw <dbl>, pnumsga <dbl>, ppbmi <dbl>, ppwt <dbl>, smoken <dbl>,
    ## #   wtgain <dbl>

Ok! So this code below is written so that I change sex from 1-2 to male
or female, and same for race. The `as.logical` function returns values
to be “true” or “false”. So you’re telling it to interpret values in
that column as yes there’s a malformation or no there’s not. Then after
I clean up this data, I want to take a look at a small 200 sample
subset.

``` r
bwt_df = 
  read_csv("extra_topic_data/birthweight.csv") |> 
  janitor::clean_names() |>
  mutate(
    babysex = as.factor(babysex),
    babysex = fct_recode(babysex, "male" = "1", "female" = "2"),
    frace = as.factor(frace),
    frace = fct_recode(
      frace, "white" = "1", "black" = "2", "asian" = "3", 
      "puerto rican" = "4", "other" = "8"),
    malform = as.logical(malform),
    mrace = as.factor(mrace),
    mrace = fct_recode(
      mrace, "white" = "1", "black" = "2", "asian" = "3", 
      "puerto rican" = "4")) |> 
  sample_n(200)
```

    ## Rows: 4342 Columns: 20
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
bwt_df
```

    ## # A tibble: 200 × 20
    ##    babysex bhead blength   bwt delwt fincome frace      gaweeks malform menarche
    ##    <fct>   <dbl>   <dbl> <dbl> <dbl>   <dbl> <fct>        <dbl> <lgl>      <dbl>
    ##  1 male       34      50  3459   124      25 black         35.9 FALSE         13
    ##  2 female     35      51  3827   130      45 white         41.3 FALSE         12
    ##  3 male       33      49  3033   117      65 white         38.9 FALSE         14
    ##  4 female     35      51  3232   136      85 white         42.4 FALSE         11
    ##  5 female     34      49  3118   126      25 black         38.7 FALSE         13
    ##  6 female     32      50  2551   111      25 puerto ri…    35.9 FALSE         13
    ##  7 male       34      51  2835   136      75 white         41   FALSE         14
    ##  8 male       33      48  2495   113      25 black         38.7 FALSE         13
    ##  9 female     35      51  3203   183      15 black         39.4 FALSE         15
    ## 10 female     33      47  2807   136      25 white         39.4 FALSE         12
    ## # ℹ 190 more rows
    ## # ℹ 10 more variables: mheight <dbl>, momage <dbl>, mrace <fct>, parity <dbl>,
    ## #   pnumlbw <dbl>, pnumsga <dbl>, ppbmi <dbl>, ppwt <dbl>, smoken <dbl>,
    ## #   wtgain <dbl>

## Building the Lasso Model

The function asks us for an outcome vector,y, and a matrix, x, of
predictors. Told you this was for cases where there are lots of
independent variables– a whole matrix! The matrix automatically creates
an intercept, which is the outcome value that would be expected if all
predictors were set to 0. We want to get rid of the first column, so I’m
telling it to make the matrix and include all rows, but get rid of the
first column.

``` r
x = model.matrix(bwt ~ ., bwt_df)
x
```

    ##     (Intercept) babysexfemale bhead blength delwt fincome fraceblack fraceasian
    ## 1             1             0    34      50   124      25          1          0
    ## 2             1             1    35      51   130      45          0          0
    ## 3             1             0    33      49   117      65          0          0
    ## 4             1             1    35      51   136      85          0          0
    ## 5             1             1    34      49   126      25          1          0
    ## 6             1             1    32      50   111      25          0          0
    ## 7             1             0    34      51   136      75          0          0
    ## 8             1             0    33      48   113      25          1          0
    ## 9             1             1    35      51   183      15          1          0
    ## 10            1             1    33      47   136      25          0          0
    ## 11            1             1    35      51   156      25          0          0
    ## 12            1             0    35      53   130      35          1          0
    ## 13            1             0    31      52   158      15          1          0
    ## 14            1             0    33      49   120      96          0          0
    ## 15            1             1    34      49   147      65          0          0
    ## 16            1             0    33      52   129      55          0          0
    ## 17            1             0    35      50   120      25          1          0
    ## 18            1             1    33      56   163      65          0          0
    ## 19            1             1    35      50   132      96          0          0
    ## 20            1             0    33      50   127      25          1          0
    ## 21            1             0    35      52   161      45          0          0
    ## 22            1             0    35      52   135      85          1          0
    ## 23            1             1    36      46   120      85          0          0
    ## 24            1             1    34      51   188      55          0          0
    ## 25            1             1    32      48   124      25          1          0
    ## 26            1             1    35      49   133      85          0          0
    ## 27            1             0    34      48   161      85          0          0
    ## 28            1             0    33      47   124      25          0          0
    ## 29            1             1    33      49   115      96          0          0
    ## 30            1             0    34      51   124      55          1          0
    ## 31            1             0    33      51   149       5          1          0
    ## 32            1             0    34      50   156      55          1          0
    ## 33            1             1    34      50   135      15          1          0
    ## 34            1             0    36      51   142      55          0          0
    ## 35            1             0    34      51   144      95          0          0
    ## 36            1             0    35      51   195      75          0          0
    ## 37            1             1    33      48   150      45          1          0
    ## 38            1             1    34      50   137      35          1          0
    ## 39            1             0    34      50   150      45          1          0
    ## 40            1             1    32      50   146      75          1          0
    ## 41            1             1    34      52   165      65          0          0
    ## 42            1             1    34      51   123      25          1          0
    ## 43            1             1    33      49   132      65          1          0
    ## 44            1             1    27      38   123      35          1          0
    ## 45            1             0    34      52   161      25          0          0
    ## 46            1             0    31      44   130      35          1          0
    ## 47            1             0    35      52   134      25          0          0
    ## 48            1             1    33      51   122      15          0          0
    ## 49            1             0    36      51   146      15          1          0
    ## 50            1             0    36      54   165      15          0          0
    ## 51            1             1    35      49   168      45          1          0
    ## 52            1             0    37      56   171      25          1          0
    ## 53            1             1    32      48   143      55          0          0
    ## 54            1             1    33      48   155      96          0          0
    ## 55            1             0    33      49   147      95          0          0
    ## 56            1             0    33      49   176      96          0          0
    ## 57            1             1    33      50   187      45          0          0
    ## 58            1             1    32      49   155      35          1          0
    ## 59            1             1    34      48   135      15          0          0
    ## 60            1             0    32      47   120      25          0          0
    ## 61            1             1    33      47   136      95          0          0
    ## 62            1             1    34      51   155      15          1          0
    ## 63            1             1    33      50   187      96          0          0
    ## 64            1             1    36      53   159      15          1          0
    ## 65            1             1    33      48   157      25          0          0
    ## 66            1             0    35      52   202      35          1          0
    ## 67            1             0    33      52   128      15          0          0
    ## 68            1             0    34      47   134      75          1          0
    ## 69            1             0    34      47   123      25          0          0
    ## 70            1             0    34      53   185      45          0          0
    ## 71            1             0    35      47   149      45          1          0
    ## 72            1             0    34      50   154      55          0          0
    ## 73            1             0    34      51   110      35          0          0
    ## 74            1             0    32      49   140      25          1          0
    ## 75            1             0    36      53   145      85          0          0
    ## 76            1             1    32      49   158      25          1          0
    ## 77            1             0    31      45   175      25          0          0
    ## 78            1             0    31      49   142      25          1          0
    ## 79            1             1    33      50   147      55          1          0
    ## 80            1             0    34      51   131      15          1          0
    ## 81            1             0    34      49   198      15          1          0
    ## 82            1             1    34      50   157      55          1          0
    ## 83            1             1    32      49   119      45          1          0
    ## 84            1             1    35      50   174      96          0          0
    ## 85            1             0    33      48   151      96          0          0
    ## 86            1             1    34      54   217       5          1          0
    ## 87            1             0    34      48   155      85          0          0
    ## 88            1             0    34      49   128      95          0          0
    ## 89            1             0    34      53   152      65          0          0
    ## 90            1             1    33      49   134       5          1          0
    ## 91            1             1    33      50   146       5          1          0
    ## 92            1             0    35      51   141       5          0          0
    ## 93            1             0    34      46   153      35          1          0
    ## 94            1             0    33      50   141      25          0          0
    ## 95            1             0    34      51   137      35          0          0
    ## 96            1             0    32      52   140      95          1          0
    ## 97            1             1    35      53   172      85          0          0
    ## 98            1             1    35      49   160      25          1          0
    ## 99            1             0    35      54   120      35          0          0
    ## 100           1             1    34      49   129      35          0          0
    ## 101           1             1    33      50   174      55          1          0
    ## 102           1             1    31      51   146      25          0          0
    ## 103           1             1    33      48   123       5          1          0
    ## 104           1             1    30      47   216      35          1          0
    ## 105           1             0    34      50   138      45          0          0
    ## 106           1             1    32      47   107      25          1          0
    ## 107           1             0    36      55   176      25          0          0
    ## 108           1             0    34      63   143      25          0          0
    ## 109           1             1    30      41   110      15          1          0
    ## 110           1             0    33      47   149      95          0          0
    ## 111           1             1    35      53   162      55          0          0
    ## 112           1             0    35      52    97      45          1          0
    ## 113           1             1    34      49   139      65          0          0
    ## 114           1             0    33      47   180      35          1          0
    ## 115           1             0    34      52   152      35          0          0
    ## 116           1             1    33      50   149      25          1          0
    ## 117           1             1    33      48   147      96          0          0
    ## 118           1             0    33      51   164      15          1          0
    ## 119           1             0    36      50   145      15          1          0
    ## 120           1             1    32      49   151      15          1          0
    ## 121           1             0    33      50   121      25          0          1
    ## 122           1             1    33      50   181      15          1          0
    ## 123           1             0    36      50   113      55          0          0
    ## 124           1             1    33      52   157      15          1          0
    ## 125           1             1    32      52   146      96          0          0
    ## 126           1             1    34      48   162      25          1          0
    ## 127           1             1    33      48   146      55          0          0
    ## 128           1             0    34      50   117      15          0          1
    ## 129           1             1    34      48   138      75          0          0
    ## 130           1             1    34      49   149      25          1          0
    ## 131           1             0    35      55   142      95          1          0
    ## 132           1             1    33      50   155      45          1          0
    ## 133           1             0    37      51   182      25          1          0
    ## 134           1             1    33      50   111      35          0          0
    ## 135           1             1    32      47   139      55          0          0
    ## 136           1             0    36      52   148      95          0          0
    ## 137           1             1    33      49   150      25          0          0
    ## 138           1             0    36      52   164      35          0          0
    ## 139           1             0    35      54   186      35          0          0
    ## 140           1             0    34      50   149      15          1          0
    ## 141           1             0    34      51   122      65          0          0
    ## 142           1             1    33      50   167      45          1          0
    ## 143           1             0    33      45   125      85          1          0
    ## 144           1             1    32      52   151      15          1          0
    ## 145           1             0    30      44   169      75          0          0
    ## 146           1             1    33      47   156      55          1          0
    ## 147           1             1    35      51   146      35          0          0
    ## 148           1             0    33      52   157      35          0          0
    ## 149           1             0    35      48   135      96          0          0
    ## 150           1             1    34      46   137      45          1          0
    ## 151           1             0    32      48   211      15          1          0
    ## 152           1             1    33      46   132      25          0          0
    ## 153           1             0    34      51   144      85          0          0
    ## 154           1             0    34      50   139      85          0          0
    ## 155           1             0    35      52   198      85          0          0
    ## 156           1             1    34      53   156      25          0          0
    ## 157           1             0    34      54   170      45          1          0
    ## 158           1             0    34      53   142      95          0          0
    ## 159           1             0    32      48   153      15          1          0
    ## 160           1             1    35      52   157      75          0          0
    ## 161           1             1    32      47   151      45          1          0
    ## 162           1             0    33      47   141      25          1          0
    ## 163           1             0    36      51   148      15          1          0
    ## 164           1             1    28      38   166      55          1          0
    ## 165           1             1    22      39   114      25          1          0
    ## 166           1             0    34      49   128      96          0          0
    ## 167           1             0    31      46   166      55          1          0
    ## 168           1             1    34      51   124      55          0          0
    ## 169           1             1    31      48   139      25          1          0
    ## 170           1             0    34      50   151      35          1          0
    ## 171           1             0    35      53   161      75          0          0
    ## 172           1             1    34      49   203      35          1          0
    ## 173           1             0    33      49   133      35          0          0
    ## 174           1             1    34      48   262      65          1          0
    ## 175           1             1    33      51   144      96          0          0
    ## 176           1             1    34      49   128       5          0          0
    ## 177           1             1    34      49   162      96          0          0
    ## 178           1             1    33      48   128      65          0          0
    ## 179           1             0    35      53   139      55          0          0
    ## 180           1             1    34      51   137      96          0          0
    ## 181           1             1    32      50   137      65          0          0
    ## 182           1             0    35      49   137      95          0          0
    ## 183           1             0    35      50   151      75          0          0
    ## 184           1             0    33      51   144      25          0          0
    ## 185           1             0    32      49   130      55          0          0
    ## 186           1             0    32      46   134      45          0          0
    ## 187           1             0    35      49   140      75          0          0
    ## 188           1             0    35      50   142      35          1          0
    ## 189           1             1    32      49   165       5          0          0
    ## 190           1             0    35      47   138      95          0          0
    ## 191           1             1    31      45   174       5          0          0
    ## 192           1             0    32      46   129      15          1          0
    ## 193           1             0    35      52   138      95          0          0
    ## 194           1             1    34      51   175      75          0          0
    ## 195           1             1    34      48   139      25          0          0
    ## 196           1             0    34      51   118      35          0          0
    ## 197           1             1    33      50   144      25          1          0
    ## 198           1             0    34      51    98      25          0          1
    ## 199           1             0    31      48   137      15          1          0
    ## 200           1             1    33      51   162      15          1          0
    ##     fracepuerto rican fraceother gaweeks malformTRUE menarche mheight momage
    ## 1                   0          0    35.9           0       13      62     16
    ## 2                   0          0    41.3           0       12      61     22
    ## 3                   0          0    38.9           0       14      62     24
    ## 4                   0          0    42.4           0       11      63     36
    ## 5                   0          0    38.7           0       13      62     21
    ## 6                   1          0    35.9           0       13      62     16
    ## 7                   0          0    41.0           0       14      67     22
    ## 8                   0          0    38.7           0       13      63     21
    ## 9                   0          0    39.4           0       15      69     16
    ## 10                  0          0    39.4           0       12      58     19
    ## 11                  0          0    39.3           0       12      66     22
    ## 12                  0          0    45.4           0       15      63     16
    ## 13                  0          0    39.4           0       13      68     17
    ## 14                  0          0    40.4           0       11      61     18
    ## 15                  0          0    40.7           0       15      70     24
    ## 16                  0          0    40.7           0       12      66     23
    ## 17                  0          0    35.1           0       12      62     18
    ## 18                  0          0    41.3           0       13      69     24
    ## 19                  0          0    41.6           0       15      62     23
    ## 20                  0          0    37.6           0       14      62     22
    ## 21                  0          0    42.1           0       10      65     23
    ## 22                  0          0    37.6           0       13      64     19
    ## 23                  0          0    41.1           0       13      61     25
    ## 24                  0          0    42.0           0       12      66     18
    ## 25                  0          0    41.4           0       12      60     18
    ## 26                  0          0    40.7           0       13      65     19
    ## 27                  0          0    39.6           0       11      63     32
    ## 28                  0          0    36.3           0       12      64     17
    ## 29                  0          0    40.0           0       13      62     21
    ## 30                  0          0    40.7           0       15      62     18
    ## 31                  0          0    38.7           0       13      68     16
    ## 32                  0          0    42.4           0       11      67     24
    ## 33                  0          0    35.0           0       13      62     16
    ## 34                  0          0    40.0           0       14      61     28
    ## 35                  0          0    43.4           0       13      62     28
    ## 36                  0          0    42.0           0        9      65     24
    ## 37                  0          0    33.4           0       13      62     23
    ## 38                  0          0    35.9           0       15      62     19
    ## 39                  0          0    39.3           0       13      58     21
    ## 40                  0          0    39.9           0       13      62     19
    ## 41                  0          0    42.4           0       12      64     21
    ## 42                  0          0    40.9           0       12      58     17
    ## 43                  0          0    40.1           0       12      66     18
    ## 44                  0          0    34.9           0       11      62     21
    ## 45                  0          0    41.1           0       14      65     25
    ## 46                  0          0    37.7           0       15      63     19
    ## 47                  1          0    40.0           0       11      59     16
    ## 48                  0          0    38.6           0       12      62     18
    ## 49                  0          0    39.9           0       13      65     24
    ## 50                  0          0    47.0           0       15      66     20
    ## 51                  0          0    40.9           0       12      67     21
    ## 52                  0          0    41.1           0       12      64     14
    ## 53                  0          0    38.9           0       13      62     19
    ## 54                  0          0    43.0           0       13      66     21
    ## 55                  0          0    39.9           0       12      62     23
    ## 56                  0          0    41.4           0       13      66     37
    ## 57                  0          0    40.9           0       13      66     22
    ## 58                  0          0    38.9           0       14      66     21
    ## 59                  0          0    39.7           0       12      64     19
    ## 60                  0          0    39.9           0       11      62     22
    ## 61                  0          0    38.7           0       13      60     23
    ## 62                  0          0    39.0           0       12      55     21
    ## 63                  0          0    40.1           0       13      63     26
    ## 64                  0          0    41.3           0       13      67     17
    ## 65                  0          0    40.6           0       13      63     19
    ## 66                  0          0    39.3           0       11      67     21
    ## 67                  0          0    37.6           0       12      63     19
    ## 68                  0          0    37.6           0       13      63     19
    ## 69                  1          0    35.3           0       14      56     17
    ## 70                  0          0    39.4           0       12      68     21
    ## 71                  0          0    38.9           0       13      63     41
    ## 72                  0          0    40.6           0       12      61     22
    ## 73                  0          0    40.3           0       11      61     22
    ## 74                  0          0    34.4           0       12      64     14
    ## 75                  0          0    41.0           0       12      66     21
    ## 76                  0          0    37.3           0       13      67     16
    ## 77                  0          0    39.1           0       13      66     36
    ## 78                  0          0    37.3           0       11      64     21
    ## 79                  0          0    43.6           0       13      61     25
    ## 80                  0          0    39.6           0       11      66     21
    ## 81                  0          0    39.7           0       12      68     24
    ## 82                  0          0    37.7           0       10      64     17
    ## 83                  0          0    45.7           0       13      63     17
    ## 84                  0          0    40.9           0       12      62     30
    ## 85                  0          0    39.0           0       12      65     23
    ## 86                  0          0    41.6           0       13      69     23
    ## 87                  0          0    38.7           0       12      66     20
    ## 88                  0          0    45.1           0       12      62     29
    ## 89                  0          0    41.0           0       13      64     18
    ## 90                  0          0    38.9           0       11      59     18
    ## 91                  0          0    30.3           0       13      64     15
    ## 92                  0          0    40.3           0       17      62     23
    ## 93                  0          0    38.9           0       13      67     18
    ## 94                  0          0    38.1           0       14      67     19
    ## 95                  0          0    42.4           0       11      61     18
    ## 96                  0          0    38.9           0       13      63     19
    ## 97                  0          0    42.6           0       11      67     21
    ## 98                  0          0    41.1           0       13      62     16
    ## 99                  0          0    41.7           0       13      65     18
    ## 100                 0          0    41.6           0       11      66     21
    ## 101                 0          0    37.4           0       16      63     20
    ## 102                 0          0    38.0           0       13      64     19
    ## 103                 0          0    40.7           0       13      62     18
    ## 104                 0          0    39.1           0       11      63     19
    ## 105                 1          0    41.0           0       12      59     19
    ## 106                 0          0    37.6           0       12      59     16
    ## 107                 0          0    40.6           0       10      68     27
    ## 108                 0          0    41.9           0       13      68     20
    ## 109                 0          0    35.7           0       13      61     13
    ## 110                 0          0    36.9           0       15      64     28
    ## 111                 0          0    35.1           0       11      63     17
    ## 112                 0          0    28.4           0       12      61     15
    ## 113                 0          0    40.6           0       11      62     15
    ## 114                 0          0    39.4           0       10      64     15
    ## 115                 1          0    39.4           0       13      62     20
    ## 116                 0          0    39.7           0       12      66     20
    ## 117                 0          0    41.4           0       10      63     22
    ## 118                 0          0    39.7           0       12      63     19
    ## 119                 0          0    41.6           0       12      62     18
    ## 120                 0          0    40.6           0       13      67     17
    ## 121                 0          0    38.6           0       18      61     25
    ## 122                 0          0    38.3           0        9      64     16
    ## 123                 0          0    39.3           0       15      62     27
    ## 124                 0          0    40.1           0       13      63     19
    ## 125                 0          0    33.7           0       14      62     17
    ## 126                 0          0    40.9           0       13      64     20
    ## 127                 0          0    38.6           0       13      62     30
    ## 128                 0          0    39.3           0       14      61     25
    ## 129                 0          0    38.4           0       13      68     30
    ## 130                 0          0    39.1           0       12      64     23
    ## 131                 0          0    35.0           0       12      66     30
    ## 132                 0          0    37.1           0       13      68     19
    ## 133                 0          0    43.6           0       13      68     22
    ## 134                 1          0    44.1           0       16      63     19
    ## 135                 0          0    39.1           0       12      63     18
    ## 136                 0          0    41.1           0       15      64     23
    ## 137                 0          0    39.4           0       15      68     21
    ## 138                 0          0    37.9           0       11      62     19
    ## 139                 0          0    43.3           0       12      64     23
    ## 140                 0          0    39.1           0       12      67     17
    ## 141                 0          0    36.4           0       11      59     15
    ## 142                 0          0    43.6           0       11      64     14
    ## 143                 0          0    42.4           0       13      60     18
    ## 144                 0          0    40.6           0       13      64     23
    ## 145                 0          0    32.4           0       10      66     22
    ## 146                 0          0    36.0           0       13      67     14
    ## 147                 0          0    39.4           0       10      60     18
    ## 148                 0          0    39.1           0       12      65     42
    ## 149                 0          0    40.1           0       10      64     27
    ## 150                 0          0    40.4           0       11      60     17
    ## 151                 0          0    36.9           0       14      69     19
    ## 152                 0          0    33.0           0       12      64     21
    ## 153                 0          0    40.4           0       12      64     19
    ## 154                 0          0    40.4           0       12      68     23
    ## 155                 0          0    38.7           0       12      64     23
    ## 156                 0          0    40.3           0       12      66     20
    ## 157                 0          0    40.3           0       11      66     18
    ## 158                 0          0    40.6           0       12      66     27
    ## 159                 0          0    37.9           0       12      62     15
    ## 160                 0          0    41.3           0       12      60     22
    ## 161                 0          0    41.9           0       13      65     20
    ## 162                 0          0    39.4           0       12      61     15
    ## 163                 0          0    40.9           0       14      63     17
    ## 164                 0          0    32.7           0       13      66     21
    ## 165                 0          0    39.6           0       12      61     17
    ## 166                 0          0    40.0           0       13      64     25
    ## 167                 0          0    33.7           0       11      66     16
    ## 168                 0          0    40.3           0       12      63     21
    ## 169                 0          0    34.0           0       11      60     15
    ## 170                 0          0    41.0           0       13      61     19
    ## 171                 0          0    42.4           0       13      66     30
    ## 172                 0          0    40.7           0       11      67     18
    ## 173                 0          0    38.7           0       12      61     20
    ## 174                 0          0    41.4           0       13      67     27
    ## 175                 0          0    39.7           0       11      67     24
    ## 176                 0          0    41.1           0       12      65     19
    ## 177                 0          0    39.1           0       13      69     28
    ## 178                 0          0    46.0           0       13      61     23
    ## 179                 0          0    39.9           1       13      64     20
    ## 180                 0          0    42.6           0       16      60     22
    ## 181                 1          0    44.3           0       12      62     17
    ## 182                 0          0    35.1           0       16      62     21
    ## 183                 0          0    41.7           0       12      64     19
    ## 184                 0          0    43.6           0       13      64     19
    ## 185                 0          0    31.9           0       13      64     22
    ## 186                 0          0    32.3           0       12      63     19
    ## 187                 0          0    38.3           0       13      67     26
    ## 188                 0          0    37.4           0       13      64     17
    ## 189                 0          0    41.9           0       13      66     17
    ## 190                 0          0    39.9           0       11      61     21
    ## 191                 0          0    35.7           0       11      66     19
    ## 192                 0          0    28.1           0       12      62     17
    ## 193                 0          0    40.3           1       13      65     23
    ## 194                 0          0    41.0           0       13      68     21
    ## 195                 0          0    38.0           0       11      63     20
    ## 196                 0          0    40.0           0        9      63     19
    ## 197                 0          0    40.6           0       11      61     19
    ## 198                 0          0    38.7           0       13      60     23
    ## 199                 0          0    38.0           0       12      61     22
    ## 200                 0          0    40.1           0       11      68     18
    ##     mraceblack mraceasian mracepuerto rican parity pnumlbw pnumsga    ppbmi
    ## 1            1          0                 0      0       0       0 19.24491
    ## 2            0          0                 0      0       0       0 19.88106
    ## 3            0          0                 0      0       0       0 17.22877
    ## 4            0          0                 0      0       0       0 21.30149
    ## 5            1          0                 0      0       0       0 20.52790
    ## 6            0          0                 1      0       0       0 19.24491
    ## 7            1          0                 0      0       0       0 19.93260
    ## 8            1          0                 0      0       0       0 18.28378
    ## 9            1          0                 0      0       0       0 21.16156
    ## 10           0          0                 0      0       0       0 24.08528
    ## 11           0          0                 0      0       0       0 21.83513
    ## 12           1          0                 0      0       0       0 21.47901
    ## 13           1          0                 0      0       0       0 20.11250
    ## 14           0          0                 0      0       0       0 19.88106
    ## 15           0          0                 0      0       0       0 19.26720
    ## 16           0          0                 0      0       0       0 18.60030
    ## 17           1          0                 0      0       0       0 17.77863
    ## 18           0          0                 0      0       0       0 20.71761
    ## 19           0          0                 0      0       0       0 19.97805
    ## 20           1          0                 0      0       0       0 20.16133
    ## 21           0          0                 0      0       0       0 21.67837
    ## 22           1          0                 0      0       0       0 17.88889
    ## 23           0          0                 1      0       0       0 20.82778
    ## 24           0          0                 0      0       0       0 24.26126
    ## 25           1          0                 0      0       0       0 19.17933
    ## 26           0          0                 0      0       0       0 18.00972
    ## 27           0          0                 0      0       0       0 22.18905
    ## 28           0          0                 0      0       0       0 16.51282
    ## 29           0          0                 0      0       0       0 18.69505
    ## 30           1          0                 0      0       0       0 19.61148
    ## 31           1          0                 0      0       0       0 19.04593
    ## 32           1          0                 0      0       0       0 20.40345
    ## 33           1          0                 0      0       0       0 21.62761
    ## 34           0          0                 1      0       0       0 19.88106
    ## 35           0          0                 0      0       0       0 23.09389
    ## 36           0          0                 0      0       0       0 25.84728
    ## 37           1          0                 0      0       0       0 21.99418
    ## 38           1          0                 0      0       0       0 21.07775
    ## 39           1          0                 0      0       0       0 28.27403
    ## 40           1          0                 0      0       0       0 20.16133
    ## 41           0          0                 0      0       0       0 22.01709
    ## 42           1          0                 0      0       0       0 20.52485
    ## 43           1          0                 0      0       0       0 20.37946
    ## 44           1          0                 0      0       0       0 21.07775
    ## 45           0          0                 0      0       0       0 23.34593
    ## 46           1          0                 0      0       0       0 20.41393
    ## 47           0          0                 1      0       0       0 25.50213
    ## 48           0          0                 0      0       0       0 17.96191
    ## 49           1          0                 0      0       0       0 20.84458
    ## 50           0          0                 0      0       0       0 21.34991
    ## 51           1          0                 0      0       0       0 21.18820
    ## 52           1          0                 0      0       0       0 24.08119
    ## 53           0          0                 0      0       0       0 22.17746
    ## 54           0          0                 0      0       0       0 21.34991
    ## 55           0          0                 0      0       0       0 23.64374
    ## 56           0          0                 0      0       0       0 22.32035
    ## 57           0          0                 0      0       0       0 25.06996
    ## 58           1          0                 0      0       0       0 18.60030
    ## 59           0          0                 0      0       0       0 19.78098
    ## 60           0          0                 0      0       0       0 21.99418
    ## 61           0          0                 0      0       0       0 25.44197
    ## 62           1          0                 0      0       0       0 30.27805
    ## 63           0          0                 0      0       0       0 23.96418
    ## 64           1          0                 0      0       0       0 20.40345
    ## 65           0          0                 0      0       0       0 22.54408
    ## 66           1          0                 0      0       0       0 26.68144
    ## 67           0          0                 0      0       0       0 20.41393
    ## 68           1          0                 0      0       0       0 21.12398
    ## 69           0          0                 1      0       0       0 24.71306
    ## 70           0          0                 0      0       0       0 22.09327
    ## 71           1          0                 0      0       0       0 25.20677
    ## 72           0          0                 0      0       0       0 26.69742
    ## 73           0          0                 0      0       0       0 20.25975
    ## 74           1          0                 0      0       0       0 20.64102
    ## 75           0          0                 0      0       0       0 19.89423
    ## 76           1          0                 0      0       0       0 18.83396
    ## 77           0          0                 0      0       0       0 26.20216
    ## 78           1          0                 0      0       0       0 19.09295
    ## 79           1          0                 0      0       0       0 23.47858
    ## 80           1          0                 0      0       0       0 16.98288
    ## 81           1          0                 0      0       0       0 28.18797
    ## 82           1          0                 0      0       0       0 23.39316
    ## 83           1          0                 0      0       0       0 17.75124
    ## 84           0          0                 0      0       0       0 24.74345
    ## 85           0          0                 0      0       0       0 19.51053
    ## 86           1          0                 0      0       0       0 30.33651
    ## 87           0          0                 0      0       0       0 21.02642
    ## 88           0          0                 0      0       0       0 19.06162
    ## 89           0          0                 0      0       0       0 20.98504
    ## 90           1          0                 0      0       0       0 24.89493
    ## 91           1          0                 0      0       0       0 24.08119
    ## 92           0          0                 0      0       0       0 18.32848
    ## 93           1          0                 0      0       0       0 19.14785
    ## 94           0          0                 0      0       0       0 20.40345
    ## 95           0          0                 0      0       0       0 20.25975
    ## 96           1          0                 0      0       0       0 22.72159
    ## 97           0          0                 0      0       0       0 21.65905
    ## 98           1          0                 0      0       0       0 23.09389
    ## 99           0          0                 0      0       0       0 15.84188
    ## 100          0          0                 0      0       0       0 19.40900
    ## 101          1          0                 0      0       0       0 24.85174
    ## 102          0          0                 0      0       0       0 21.15705
    ## 103          1          0                 0      0       0       0 19.79476
    ## 104          1          0                 0      0       0       0 34.61493
    ## 105          0          0                 1      0       0       0 19.22779
    ## 106          1          0                 0      0       0       0 21.25177
    ## 107          0          0                 0      0       0       0 21.02670
    ## 108          0          0                 0      0       0       0 18.58882
    ## 109          1          0                 0      0       0       0 19.88106
    ## 110          0          0                 0      0       0       0 23.22115
    ## 111          0          0                 0      0       0       0 22.18905
    ## 112          1          0                 0      0       0       0 16.09419
    ## 113          0          0                 0      0       0       0 23.46046
    ## 114          1          0                 0      0       0       0 28.03739
    ## 115          0          0                 1      0       0       0 24.01031
    ## 116          1          0                 0      0       0       0 19.57075
    ## 117          0          0                 0      0       0       0 23.43164
    ## 118          1          0                 0      0       0       0 25.73930
    ## 119          1          0                 0      0       0       0 22.72732
    ## 120          1          0                 0      0       0       0 19.61870
    ## 121          0          1                 0      0       0       0 16.66222
    ## 122          1          0                 0      0       0       0 31.99358
    ## 123          0          0                 0      0       0       0 18.87834
    ## 124          1          0                 0      0       0       0 21.83403
    ## 125          0          0                 0      0       0       0 23.82703
    ## 126          1          0                 0      0       0       0 23.73717
    ## 127          0          0                 0      0       0       0 23.82703
    ## 128          0          1                 0      0       0       0 17.98763
    ## 129          0          0                 0      0       0       0 19.80776
    ## 130          1          0                 0      0       0       0 20.64102
    ## 131          1          0                 0      0       0       0 20.54120
    ## 132          1          0                 0      0       0       0 20.72197
    ## 133          1          0                 0      0       0       0 22.85511
    ## 134          0          0                 1      0       0       0 16.68617
    ## 135          0          0                 0      0       0       0 20.76896
    ## 136          0          0                 0      0       0       0 21.50106
    ## 137          0          0                 0      0       0       0 21.33144
    ## 138          0          0                 0      0       0       0 24.74345
    ## 139          0          0                 0      0       0       0 25.80128
    ## 140          1          0                 0      0       0       0 19.61870
    ## 141          0          0                 0      0       0       0 20.23978
    ## 142          1          0                 0      0       0       0 30.10149
    ## 143          1          0                 0      0       0       0 19.17933
    ## 144          1          0                 0      0       0       0 21.84508
    ## 145          0          0                 0      0       0       0 25.06996
    ## 146          1          0                 0      0       0       0 19.93260
    ## 147          0          0                 0      0       0       0 24.46343
    ## 148          0          0                 0      0       0       0 23.01242
    ## 149          0          0                 0      0       0       0 20.64102
    ## 150          1          0                 0      0       0       0 21.52782
    ## 151          1          0                 0      0       0       0 28.11676
    ## 152          0          0                 0      0       0       0 18.23290
    ## 153          0          0                 0      0       0       0 21.15705
    ## 154          0          0                 0      0       0       0 17.06515
    ## 155          0          0                 0      0       0       0 29.24145
    ## 156          0          0                 0      0       0       0 22.64384
    ## 157          1          0                 0      0       0       0 19.40900
    ## 158          0          0                 0      0       0       0 18.27681
    ## 159          1          0                 0      0       0       0 21.99418
    ## 160          0          0                 0      0       0       0 25.83339
    ## 161          1          0                 0      0       0       0 18.34323
    ## 162          1          0                 0      0       0       0 19.88106
    ## 163          1          0                 0      0       0       0 23.07662
    ## 164          1          0                 0      0       0       0 25.87867
    ## 165          1          0                 0      0       0       0 19.31303
    ## 166          0          0                 0      0       0       0 18.40491
    ## 167          1          0                 0      0       0       0 24.26126
    ## 168          0          0                 0      0       0       0 20.05890
    ## 169          1          0                 0      0       0       0 24.46343
    ## 170          1          0                 0      0       0       0 26.31874
    ## 171          0          0                 0      0       0       0 21.02642
    ## 172          1          0                 0      0       0       0 29.82043
    ## 173          0          0                 0      0       0       0 21.39581
    ## 174          1          0                 0      0       0       0 29.82043
    ## 175          0          0                 0      0       0       0 19.93260
    ## 176          0          0                 0      0       0       0 18.67674
    ## 177          0          0                 0      0       0       0 21.45753
    ## 178          0          0                 0      0       0       0 18.74500
    ## 179          0          0                 0      0       0       0 19.26495
    ## 180          0          0                 0      0       0       0 20.94070
    ## 181          0          0                 1      0       0       0 20.16133
    ## 182          0          0                 0      0       0       0 20.52790
    ## 183          0          0                 0      0       0       0 21.50106
    ## 184          0          0                 0      0       0       0 20.64102
    ## 185          0          0                 0      0       0       0 20.29700
    ## 186          0          0                 0      0       0       0 22.89911
    ## 187          0          0                 0      0       0       0 20.71735
    ## 188          1          0                 0      0       0       0 19.09295
    ## 189          0          0                 0      0       0       0 21.83513
    ## 190          0          0                 0      0       0       0 23.28924
    ## 191          0          0                 0      0       0       0 24.90822
    ## 192          1          0                 0      0       0       0 18.32848
    ## 193          0          0                 0      0       0       0 19.67728
    ## 194          0          0                 0      0       0       0 20.87433
    ## 195          0          0                 0      0       0       0 19.17134
    ## 196          0          0                 0      0       0       0 17.39622
    ## 197          1          0                 0      0       0       0 26.12939
    ## 198          0          1                 0      0       0       0 16.43943
    ## 199          1          0                 0      0       0       0 20.25975
    ## 200          1          0                 0      0       0       0 20.56960
    ##     ppwt smoken wtgain
    ## 1    105  0.000     19
    ## 2    105  0.000     25
    ## 3     94  0.000     23
    ## 4    120  0.000     16
    ## 5    112  0.000     14
    ## 6    105  0.000      6
    ## 7    127 20.000      9
    ## 8    103 11.000     10
    ## 9    143  0.000     40
    ## 10   115 30.000     21
    ## 11   135  2.000     21
    ## 12   121  0.000      9
    ## 13   132  0.000     26
    ## 14   105  0.000     15
    ## 15   134  0.000     13
    ## 16   115  0.000     14
    ## 17    97  0.000     23
    ## 18   140  0.000     23
    ## 19   109  0.000     23
    ## 20   110  0.000     17
    ## 21   130 25.000     31
    ## 22   104  0.000     31
    ## 23   110  0.000     10
    ## 24   150 10.000     38
    ## 25    98 15.000     26
    ## 26   108  3.000     25
    ## 27   125  0.000     36
    ## 28    96 33.000     28
    ## 29   102  0.000     13
    ## 30   107 19.000     17
    ## 31   125  1.000     24
    ## 32   130  0.000     26
    ## 33   118  0.000     17
    ## 34   105  0.000     37
    ## 35   126  0.000     18
    ## 36   155  3.000     40
    ## 37   120  0.000     30
    ## 38   115  0.000     22
    ## 39   135  0.000     15
    ## 40   110  6.000     36
    ## 41   128  0.000     37
    ## 42    98  0.000     25
    ## 43   126  0.000      6
    ## 44   115  0.000      8
    ## 45   140  0.000     21
    ## 46   115  0.000     15
    ## 47   126  0.000      8
    ## 48    98 20.000     24
    ## 49   125 10.000     21
    ## 50   132 20.000     33
    ## 51   135  4.000     33
    ## 52   140  0.000     31
    ## 53   121  0.000     22
    ## 54   132  8.000     23
    ## 55   129  0.000     18
    ## 56   138  0.000     38
    ## 57   155  0.000     32
    ## 58   115  3.000     40
    ## 59   115  8.000     20
    ## 60   120  8.000      0
    ## 61   130  0.000      6
    ## 62   130  0.000     25
    ## 63   135  0.000     52
    ## 64   130  0.000     29
    ## 65   127 15.000     30
    ## 66   170  1.000     32
    ## 67   115  1.000     13
    ## 68   119  0.000     15
    ## 69   110  0.000     13
    ## 70   145 20.000     40
    ## 71   142  2.000      7
    ## 72   141  8.000     13
    ## 73   107  0.000      3
    ## 74   120  0.000     20
    ## 75   123  8.000     22
    ## 76   120  0.000     38
    ## 77   162  6.000     13
    ## 78   111  1.000     31
    ## 79   124  0.000     23
    ## 80   105  0.000     26
    ## 81   185  0.000     13
    ## 82   136  0.000     21
    ## 83   100  0.000     19
    ## 84   135  0.000     39
    ## 85   117 30.000     34
    ## 86   205  0.000     12
    ## 87   130  0.000     25
    ## 88   104  0.000     24
    ## 89   122 20.000     30
    ## 90   123  7.000     11
    ## 91   140  0.000      6
    ## 92   100  0.000     41
    ## 93   122  0.000     31
    ## 94   130  0.000     11
    ## 95   107  0.000     30
    ## 96   128  0.000     12
    ## 97   138  0.000     34
    ## 98   126  0.000     34
    ## 99    95 16.000     25
    ## 100  120  0.000      9
    ## 101  140  0.000     34
    ## 102  123  0.000     23
    ## 103  108  0.000     15
    ## 104  195  0.000     21
    ## 105   95  0.000     43
    ## 106  105  0.000      2
    ## 107  138  0.000     38
    ## 108  122  0.000     21
    ## 109  105  2.000      5
    ## 110  135  0.000     14
    ## 111  125  0.000     37
    ## 112   85  0.000     12
    ## 113  128  0.000     11
    ## 114  163  0.000     17
    ## 115  131  1.000     21
    ## 116  121  9.000     28
    ## 117  132 12.000     15
    ## 118  145  0.000     19
    ## 119  124  0.000     21
    ## 120  125  2.000     26
    ## 121   88  0.000     33
    ## 122  186  0.000     -5
    ## 123  103  0.000     10
    ## 124  123  0.000     34
    ## 125  130  0.000     16
    ## 126  138  0.125     24
    ## 127  130  0.000     16
    ## 128   95  0.000     22
    ## 129  130 15.000      8
    ## 130  120  7.000     29
    ## 131  127  0.000     15
    ## 132  136  0.000     19
    ## 133  150  0.000     32
    ## 134   94 20.000     17
    ## 135  117  0.000     22
    ## 136  125  0.000     23
    ## 137  140  1.000     10
    ## 138  135  0.000     29
    ## 139  150 10.000     36
    ## 140  125  0.000     24
    ## 141  100  2.000     22
    ## 142  175  0.125     -8
    ## 143   98  4.000     27
    ## 144  127  0.000     24
    ## 145  155  3.000     14
    ## 146  127  3.000     29
    ## 147  125  0.000     21
    ## 148  138 40.000     19
    ## 149  120  0.000     15
    ## 150  110  1.000     27
    ## 151  190 20.000     21
    ## 152  106  0.000     26
    ## 153  123 15.000     21
    ## 154  112  0.000     27
    ## 155  170  0.000     28
    ## 156  140  0.000     16
    ## 157  120  0.000     50
    ## 158  113  0.000     29
    ## 159  120  7.000     33
    ## 160  132 10.000     25
    ## 161  110  2.000     41
    ## 162  105  0.000     36
    ## 163  130  0.000     18
    ## 164  160 15.000      6
    ## 165  102  0.000     12
    ## 166  107 10.000     21
    ## 167  150  4.000     16
    ## 168  113  0.000     11
    ## 169  125  0.000     14
    ## 170  139  0.000     12
    ## 171  130  0.000     31
    ## 172  190  0.000     13
    ## 173  113  3.000     20
    ## 174  190  0.000     72
    ## 175  127  0.000     17
    ## 176  112 10.000     16
    ## 177  145  0.000     17
    ## 178   99  5.000     29
    ## 179  112  0.000     27
    ## 180  107  0.000     30
    ## 181  110 10.000     27
    ## 182  112 12.000     25
    ## 183  125  8.000     26
    ## 184  120  4.000     24
    ## 185  118 20.000     12
    ## 186  129  0.000      5
    ## 187  132  0.000      8
    ## 188  111  5.000     31
    ## 189  135  6.000     30
    ## 190  123  2.000     15
    ## 191  154  9.000     20
    ## 192  100  0.000     29
    ## 193  118  0.000     20
    ## 194  137 13.000     38
    ## 195  108  5.000     31
    ## 196   98  0.000     20
    ## 197  138  0.000      6
    ## 198   84  0.000     14
    ## 199  107  0.000     30
    ## 200  135  4.000     27
    ## attr(,"assign")
    ##  [1]  0  1  2  3  4  5  6  6  6  6  7  8  9 10 11 12 12 12 13 14 15 16 17 18 19
    ## attr(,"contrasts")
    ## attr(,"contrasts")$babysex
    ## [1] "contr.treatment"
    ## 
    ## attr(,"contrasts")$frace
    ## [1] "contr.treatment"
    ## 
    ## attr(,"contrasts")$malform
    ## [1] "contr.treatment"
    ## 
    ## attr(,"contrasts")$mrace
    ## [1] "contr.treatment"
